# PicoCTF 2023 Binary Exploitation: hijacking - 200 points
## Background 
PicoCTF is an annual cybersecurity competition held by professionals from Carnegie Mellon University which challenges competitorsâ€™ problem solving skills with various tasks with the objective to obtain a flag to get points. Each task has a slight description, followed with an instance button or a file. With the goal in mind of getting the flag, the competitor must exploit computer related vulnerabilities to extract the flag even though it may seem impossible at first in some cases.

## hijacking Intro
Scenario with important info highlighted

![info](https://cdn.discordapp.com/attachments/803021452797411348/1087241881131429948/image.png)

### Takeaways
* There is a python file
* It is a hidden file
* It is key to obtaining root in this scenario

## Phase 1: Recon
It is important to explore our surroundings for loopholes and vulnerabilities when the goal of privelege escalation is in mind.

![code](https://cdn.discordapp.com/attachments/803021452797411348/1087244613749833758/image.png)

### Takeaways from our exploration
* The python file is NOT editable
* The python file returns an error upon running on line 7
* We have permissions to execute our python file, as well as the python binary as sudo

## Phase 2: Constructing a plan
A crucial skill every hacker should have is making something, out of what may seem like nothing. This challenge may seem impossible since we cannot edit the python file. Because if we could, it would be as easy as spawning a shell. However, we need to think outside the box. We need to think about an external function this code uses that we can manipulate. We need to think about another way we can make this python code do what we want it to do. Then it should finally come to us. The answer is the imports. If we are able to manipulate the imported libraries and able to fill them with our own code, like maybe spawning a shell, our seemingly useless code can come to our advantage.

Our plan:
* See if a library has read, write, and execute permissions for everyone (rwx or 777 permissions)
* If it does, our plan can work. We then need to inject our own code into the python file of the library
* Run our python file as sudo (if you recall, we know we have permissions to do this thanks to our friend sudo -l)
* Free root, free flag, happy PicoCTF teammates

## Phase 3: Execution ðŸ’£
Let's search for our vulnerable library

![searching](https://cdn.discordapp.com/attachments/803021452797411348/1087247840864129034/image.png)

Bingo! There it is, good old base64 with RWX permissions. We can now inject our code. However, we need to keep in mind that if we inject our code intto the b64 encode function, it will never get called because of the dumb error on line 7. So, we need to put it on the very top of the base64 library's code so that when the file .server.py tries to import base64, it spawns us a root shell. 

![inj](https://cdn.discordapp.com/attachments/803021452797411348/1087249964951928842/image.png)

```
import os
os.system("/bin/bash")
```

Now with our library hijacked, let's test it out.

![flag](https://cdn.discordapp.com/attachments/803021452797411348/1087249586697031680/image.png)

